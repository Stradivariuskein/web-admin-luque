DO BARRE WITH 'D'

CLEAR
@ 15,30 SAY 'Inicializando Acumulados ...'
SELE 1
USE ACUM
INDEX ON MES + DIA TO ACUM

@ 15,30 SAY 'Inicializando Articulos ....'
SELE 1
USE ARTIC
INDEX ON COD_ART TO ARTIC

@ 15,30 SAY 'Inicializando Caja   ....'
SELE 1
USE CAJAIG
INDEX ON RUBRO TO CAJAIG
INDEX ON FECHA TO CAJAIG2
INDEX ON NRO TO CAJAIG3


@ 15,30 SAY 'Inicializando Vendedores....'
SELE 1
USE VENDEDOR
INDEX ON COD_VEND TO VENDEDOR

@ 15,30 SAY 'Inicializando Clientes  ....'
SELE 1
USE CLIENTES
INDEX ON COD_CLI TO CLIENTES

@ 15,30 SAY 'Inicializando Compras   ....'
SELE 1
USE COMPRAS
INDEX ON N_INT TO COMPRAS


@ 15,30 SAY 'Inicializando Facturas  ....'
SELE 2
USE COMPRO1
INDEX ON TIPO + STR(NUMERO,5,0) TO COMPRO1
INDEX ON CLIENTE TO COMPRO2

SELE 1
USE FACANCE
INDEX ON OPERACION TO FACANCE

SELE 1
USE DETALLE1
INDEX ON TIPO + STR(NUMERO,5,0) TO DETALLE1

@ 15,30 SAY 'Inicializando Proveedores ..'
SELE 7
USE PROVEDOR
INDEX ON COD_PRO TO PROVEDOR

SELE 1
USE CONTADO1
INDEX ON TIPO TO CONTADO1

@ 15,30 SAY 'Inicializando documentos  ..'
SELE 1
USE DOCUM
INDEX ON STR(NRO,5,0) + STR(NROINT,5,0) TO DOCUM
INDEX ON NROINT TO DOCUM2

@ 15,30 SAY 'Inicializando dolares     ..'
SELE 1
USE DOLAR
INDEX ON FECHA TO DOLAR

@ 15,30 SAY 'Inicializando SUCURSALES  ..'
SELE 1
USE DOMICILI
INDEX ON CLIENTE + STR(SUCURSAL,3,0) TO DOMICILI

@ 15,30 SAY 'Inicializando EXPRESOS    ..'
SELE 1
USE EXPRESO
INDEX ON NUMERO TO EXPRESO

@ 15,30 SAY 'Inicializando RUBROS      ..'
SELE 1
USE RUBROS
INDEX ON COD_RUB TO RUBROS

SELE 1
USE RUBROA
INDEX ON COD_RUB TO RUBROA


@ 15,30 SAY 'Inicializando SEGURI      ..'
SELE 1
USE SEGURI
INDEX ON CLAVE TO SEGURI

@ 15,30 SAY 'Inicializando BANCOS      ..'
SELE 1
USE BANCOS
INDEX ON NUMERO TO BANCOS


@ 15,30 SAY 'Inicializando M.PRIMAS    ..'
SELE 1
USE MPRIMA
INDEX ON CODIGO TO MPRIMA

@ 15,30 SAY 'Inicializando Provincias'
SELE 1
USE PROVI
INDEX ON NUMERO TO PROVI

CLOSE ALL
DO BARRE WITH 'P'


PROCEDURE BARRE
********* *****
PARAMETERS M_FUNC

PRIVATE I
DECLARE TABLA[ADIR("*.DBF")]
ADIR("*.DBF",TABLA)
FOR I=1 TO LEN(TABLA)
   S=BASEPD(TABLA[I],M_FUNC)
   IF S<>0
      CLEAR
      @ 24,25 SAY "PROBLEMAS CON EL ARCHIVO: "+TABLA[I]
      INKEY(0)
      CLEAR
   ENDIF
NEXT I
CLEAR
CLOSE ALL
RETURN

FUNCTION BASEPD
* Protege o desprotege un archivo.
* Devuelve: 1- Archivo inexistente
*           2- Error de lectura / grabacion
*           0- Ok
PRIVATE _NOM_ARCH,_LLAVE,_ARCH,HANDLE,SALE
PARAMETERS _NOM_ARCH,_LLAVE
IF UPPER(SUBSTR(_NOM_ARCH,LEN(_NOM_ARCH)-3,4))<>".DBF"
   _ARCH=_NOM_ARCH+".DBF"
ELSE
   _ARCH=_NOM_ARCH
ENDIF
IF .NOT. FILE("&_ARCH")
   RETURN(1)
ENDIF
IF _LLAVE="D" .OR. _LLAVE="d"
   SALE=""
ELSE
   SALE=")"
ENDIF
HANDLE = FOPEN ("&_ARCH",2)
IF FERROR() <> 0
   FCLOSE(HANDLE)
   RETURN(2)
ENDIF
FSEEK(HANDLE,0,0)
FWRITE(HANDLE,SALE,1)
FCLOSE(HANDLE)
RETURN(0)
